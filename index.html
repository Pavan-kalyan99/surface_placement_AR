<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-ar-hit-test-component@1.1.0/dist/aframe-ar-hit-test-component.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #111;
        color: white;
        font-family: sans-serif;
        height: 100vh;
      }
      #startBtn {
        padding: 12px 24px;
        font-size: 18px;
        border: none;
        border-radius: 8px;
        background: #4caf50;
        color: white;
        cursor: pointer;
      }
      #errorMsg {
        color: #ff5555;
        font-size: 16px;
        margin-top: 20px;
        display: none;
      }
      a-scene {
        display: none; /* hidden until AR starts */
      }
    </style>
  </head>

  <body>
    <button id="startBtn">Start AR</button>
    <div id="errorMsg"></div>

 <a-scene
  renderer="colorManagement: true; physicallyCorrectLights: true;"
  webxr="optionalFeatures: hit-test, local-floor;"
  xr-mode-ui="enabled: false;"
  embedded
  ar-hit-test="target:#model; type: transient; allowedPlanes: horizontal"
>
  <a-assets>
    <a-asset-item id="my-model" src="assets/asset.glb"></a-asset-item>
  </a-assets>

  <a-entity
    id="model"
    gltf-model="#my-model"
    scale="0.2 0.2 0.2"
    visible="false"
  ></a-entity>

  <a-camera></a-camera>
</a-scene>

    <script>
      const startBtn = document.getElementById("startBtn");
      const scene = document.getElementById("arScene");
      const errorMsg = document.getElementById("errorMsg");

      startBtn.addEventListener("click", async () => {
        try {
          // check if XR is available
          if (!navigator.xr) {
            throw new Error("WebXR not supported on this device/browser.");
          }

          const isSupported = await navigator.xr.isSessionSupported("immersive-ar");
          if (!isSupported) {
            throw new Error("AR mode is not supported on this device.");
          }

          // hide start button, show scene
          startBtn.style.display = "none";
          scene.style.display = "block";

          // enter AR session
          scene.enterVR();
        } catch (err) {
          console.error(err);
          errorMsg.innerText = err.message;
          errorMsg.style.display = "block";
        }
      });

      // tap to place model
      scene.addEventListener("click", () => {
        const model = document.getElementById("model");
        model.setAttribute("visible", "true");
      });
    </script>
  </body>
</html>
